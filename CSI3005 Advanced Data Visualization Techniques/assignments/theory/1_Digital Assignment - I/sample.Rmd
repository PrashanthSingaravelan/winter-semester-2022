---
title: "R Notebook"
output: html_notebook
---

## Importing the libraries
```{r}
library(tidyverse)
library(plotly)

require(devtools)
```

## Importing the data-set
```{r}
# National Parks in California
ca = read_csv("https://raw.githubusercontent.com/ScienceParkStudyGroup/r-lesson-based-on-ohi-data-training/gh-pages/data/ca.csv") 

head(ca)
```

## Analysing the data-type of the data
```{r}
colnames(ca)
```

```{r}
str(ca)
```

## Plot-1 --> ggplot2
### Bar Plot
```{r}
labs = c(
         'CHIS'='Channel Islands National Park',
         'DEVA'='Death Valley National Park',
         'JOTR'='Joshua Tree National Park',
         'KICA'='Kings Canyon National Park',
         'LAVO'='Lassen Volcanic National Park',
         'YOSE'='Yosemite National Park',
         'SEQU'='Sequoia National Park',
         'REDW'='Redwood National Park',
         'PINN'='Pinnacles National Park'
         )
```


```{r}
bar_plot = ggplot(data=ca, aes(x = code, y = ..count.. / sum(..count..),fill = factor(code))) +
           geom_bar(color='black') + 
           labs(x = "National Parks", y = "Percentage of National Parks in the data-set", 
                title = "Occurence of the National Parks in the data-set") +
  
           scale_x_discrete(labels =labs)
           scale_y_continuous(labels = scales::percent)
           
bar_plot + coord_flip()
```

### Kernel Density Plot
```{r}
density_plot = ggplot(data=ca, aes(x =log10(visitors))) +
                geom_density(fill = "indianred3") +
                labs(x = "brain weight", y="density", title="Kernal density of the brain weight")
density_plot       
```
## Plot-2 --> plotly
### Scatter plot

```{r}
t <- list(family = "Helvetica",size = 14,color = "blue")
t1 <- list(family = "Times New Roman",color = "red")
t2 <- list(family = "Courier New",size = 14,color = "green")
t3 <- list(family = 'Arial')
```

```{r}
scatter_plot = plot_ly(data=ca, x=~year, y=~visitors,color = ~park_name, type='scatter',mode='markers') %>%
                       layout(
                          title= list(text = "<b>Body weight vs Brain weight"),
                          legend = list(title = list(text ='<b>Animals')), 
                          xaxis  = list(title = list(text ='<b>Brain Weight')),
                          yaxis  = list(title = list(text ='<b>Body Weight')),
                          plot_bgcolor='#e5ecf6')
scatter_plot
```

### Barchart
```{r}
r_group_barchart = data.table::melt(ca, id.vars='park_name') %>%
plot_ly(x = ~park_name, y = ~value, type = 'bar', name = ~variable, color = ~variable) %>%
      layout(
          title= list(text = "<b>Total Distribution based on Vore"),
          legend = list(title = list(text= '<b>Aniamal Feature')),
          xaxis  = list(title = list(text ='<b>Vores')),
          yaxis = list(title='Count', text='<b>Count'), barmode = 'group')
r_group_barchart
```

### Pie-chart
```{r}
df_order = data.frame(table(ca$park_name))
df_order
```

```{r}
pie_chart = plot_ly(type='pie', labels=df_order$Var1, values=df_order$Freq, 
                    textinfo='label+percent',insidetextorientation='radial') %>%
                    layout(
                          title= list(text = "<b>Order Distributions"),
                          legend = list(title = list(text= '<b>Order')))

pie_chart
```

### Histogram Plots
```{r}
histogram_plot = plot_ly(data = ca, x = ~(log(visitors)), name=~code,type="histogram") %>%
                  layout(
                          title= list(text = "<b>Total sleep time of Animals based on Vore"),
                          legend = list(title = list(text= '<b>Vore')),
                          xaxis  = list(title = list(text ='<b>Visitors')),
                          yaxis  = list(title = list(text ='<b>Count')))
histogram_plot
```

### Donut Chart / Open Pie-Chart
```{r}
df_vore = data.frame(table(ca$code))
df_vore
```

```{r}
donut_chart = plot_ly(labels=df_vore$Var1, values=df_vore$Freq, 
                    textinfo='label+percent') %>%
                    add_pie(hole = 0.6) %>%
                    layout(
                          title= list(text = "<b>Order Distributions"),
                          legend = list(title = list(text= '<b>Order')))

donut_chart
```

## Plot-4 --> gganimate
```{r}
library(gganimate)
library(gifski)
```

### Animate --> Scatter Plot
```{r}
#scatter_plot_animate = ggplot(data=ca, aes(year, visitors)) + geom_point() +                
#                       transition_states(park_name)
#animate(scatter_plot_animate, renderer = gifski_renderer())
```

### Animate --> Line Plot
```{r}
## filtering out only 'CHIS', 'DEVA' AND 'JOTR' Park_code
d = ca %>%
    filter(code%in%c('CHIS', 'DEVA', 'JOTR'))
d
```

```{r}
#line_plot = ggplot(d, aes(x=year, y=visitors, group=code, color=code)) + 
#                   geom_line() + geom_point() + 
#                   transition_reveal(year)

#animate(line_plot, width=300, height=300, renderer = gifski_renderer())
```
Visitors started to visit Channel Islands National Park in 1960's (latest among) has very low visitors till date.
Joshua Tree National Park has a continuous growth of visitors without a big drop.
Death Valley National Park has a continuous growth of visitors in 2010's and a gradual pick-up.

```{r}
library(dplyr)
```

```{r}
state_map = map_data('state')
head(state_map)
```

```{r}
data = state.x77
data = as.data.frame(data)
data$region = tolower(rownames(data))
head(data)
```

```{r}
data_join = left_join(state_map, data, by='region')
head(data_join)
```

```{r}
ggplot(data=data_join) + 
       geom_ploygon(aes(x=long, y=lat), group=group, color='white', fill=population)
```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```

```{r}

```
